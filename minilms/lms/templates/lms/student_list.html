{% extends "base.html" %}
{% load custom_filters %}

{% block title %}–°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤{% endblock %}

{% block content %}
    <h1>üë§ –°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</h1>
    <a class="btn btn-success mb-3" href="{% url 'lms:student_create' %}">–î–æ–±–∞–≤–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞</a>

    <table class="table table-striped">
        <thead>
            <tr>
                <th>–ò–º—è</th>
                <th>Email</th>
                <th>–ö—É—Ä—Å—ã</th>
                <th>–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã</th>
            </tr>
        </thead>
        <tbody>
        {% for student in students %}
            <tr>
                <td>{{ student.name }}</td>
                <td>{{ student.email }}</td>
                <td>
                    {% for course in student.courses.all %}
                        <div class="my-1">
                            {{ course.title }} 
                            {% if not student.certificates|dict_list_course:course %}
                                <a href="{% url 'lms:generate_certificate' course.id student.id %}" class="btn btn-sm btn-info ms-2">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</a>
                            {% else %}
                                <span class="badge bg-success">–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≥–æ—Ç–æ–≤</span>
                            {% endif %}
                        </div>
                    {% empty %}
                        <span class="text-muted">–ù–µ –∑–∞–ø–∏—Å–∞–Ω –Ω–∏ –Ω–∞ –æ–¥–∏–Ω –∫—É—Ä—Å</span>
                    {% endfor %}
                </td>
                <td>
                    {% for cert in student.certificates.all %}
                        <a href="{{ cert.pdf.url }}" target="_blank" class="btn btn-sm btn-outline-primary m-1">{{ cert.course.title }} (PDF)</a>
                    {% empty %}
                        –ù–µ—Ç
                    {% endfor %}
                </td>
            </tr>
        {% empty %}
            <tr><td colspan="4">–ù–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤.</td></tr>
        {% endfor %}
        </tbody>
    </table>

{% endblock %}